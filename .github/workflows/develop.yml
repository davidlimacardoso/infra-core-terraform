name: "Develop Deploy"

on:
  pull_request:
    branches:
      - develop
    paths:
      - 'infra/**'
  push:
    branches:
      - develop
    paths:
      - 'infra/**'
  issue_comment:
    types: 
      - created
    
permissions:
  id-token: write
  contents: read
  pull-requests: write
  issues: write


jobs:

  comment:
    if: ${{ github.event_name == 'issue_comment' && github.event.issue.pull_request && github.event.comment.body == '/apply' }}
    runs-on: ubuntu-latest
    steps:
      - name: Add comment to PR
        env:
          URL: ${{ github.event.issue.comments_url }}
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          curl \
            -X POST \
            $URL \
            -H "Content-Type: application/json" \
            -H "Authorization: token $GITHUB_TOKEN" \
            --data '{ "body": "blah blah" }'

  # add_label:
  #   runs-on: ubuntu-latest
  #   steps:
  #     - name: checkout
  #       uses: actions/checkout@v2

  #     - name: add label
  #       uses: actions-ecosystem/action-add-labels@v1
  #       with:
  #         labels: |
  #           dev

  # terraform:
  #   uses: ./.github/workflows/terraform.yml
  #   with:
  #     environment: dev
  #   secrets: inherit
